{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar _a;\n\nimport * as React from 'react';\nimport elementClosestPolyfill from 'element-closest';\nexport var InputType;\n\n(function (InputType) {\n  InputType[\"Initial\"] = \"initial\";\n  InputType[\"Keyboard\"] = \"keyboard\";\n  InputType[\"Mouse\"] = \"mouse\";\n  InputType[\"Pointer\"] = \"pointer\";\n  InputType[\"Touch\"] = \"touch\";\n})(InputType || (InputType = {}));\n\nexport var InputEventType;\n\n(function (InputEventType) {\n  InputEventType[\"KeyDown\"] = \"keydown\";\n  InputEventType[\"KeyUp\"] = \"keyup\";\n  InputEventType[\"MouseDown\"] = \"mousedown\";\n  InputEventType[\"MouseMove\"] = \"mousemove\";\n  InputEventType[\"Wheel\"] = \"wheel\";\n  InputEventType[\"MouseWheel\"] = \"mousewheel\";\n  InputEventType[\"DOMMouseScroll\"] = \"DOMMouseScroll\";\n  InputEventType[\"MSPointerDown\"] = \"MSPointerDown\";\n  InputEventType[\"MSPointerMove\"] = \"MSPointerMove\";\n  InputEventType[\"PointerDown\"] = \"pointerdown\";\n  InputEventType[\"PointerMove\"] = \"pointermove\";\n  InputEventType[\"TouchStart\"] = \"touchstart\";\n})(InputEventType || (InputEventType = {}));\n\nvar formInputs = ['input', 'select', 'textarea'];\nvar ignoreMap = [16, 17, 18, 91, 93];\nexport var inputEventMap = (_a = {}, _a[InputEventType.KeyDown] = InputType.Keyboard, _a[InputEventType.KeyUp] = InputType.Keyboard, _a[InputEventType.MouseDown] = InputType.Mouse, _a[InputEventType.MouseMove] = InputType.Mouse, _a[InputEventType.Wheel] = InputType.Mouse, _a[InputEventType.MouseWheel] = InputType.Mouse, _a[InputEventType.DOMMouseScroll] = InputType.Mouse, _a[InputEventType.MSPointerDown] = InputType.Pointer, _a[InputEventType.MSPointerMove] = InputType.Pointer, _a[InputEventType.PointerDown] = InputType.Pointer, _a[InputEventType.PointerMove] = InputType.Pointer, _a[InputEventType.TouchStart] = InputType.Touch, _a);\nvar pointerMap = {\n  2: InputType.Touch,\n  3: InputType.Touch,\n  4: InputType.Mouse\n};\n\nvar getPointerType = function (event) {\n  if (typeof event.pointerType === 'number') {\n    return pointerMap[event.pointerType];\n  } else if (event.pointerType === 'mouse') {\n    return InputType.Mouse;\n  } else {\n    return InputType.Touch;\n  }\n};\n\nvar detectWheel = function () {\n  var wheelType;\n\n  if ('onwheel' in document.createElement('div')) {\n    wheelType = 'wheel';\n  } else {\n    wheelType = document.onmousewheel !== undefined ? 'mousewheel' : 'DOMMouseScroll';\n  }\n\n  return wheelType;\n};\n\nvar containerClass = 'wdc-input-provider';\n\nvar InputProvider = function (_super) {\n  __extends(InputProvider, _super);\n\n  function InputProvider(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.ref = React.createRef();\n    _this.provideIntent = _this.props.provideIntent;\n    var storedInput, storedIntent;\n\n    try {\n      storedInput = window.sessionStorage.getItem('what-input');\n      storedIntent = window.sessionStorage.getItem('what-intent');\n    } catch (e) {\n      console.warn('Failed to retrieve input status from session storage' + e);\n    }\n\n    var supportsPassive;\n\n    try {\n      var opts = Object.defineProperty({}, 'passive', {\n        get: function () {\n          supportsPassive = true;\n        }\n      });\n\n      var stub = function () {\n        return;\n      };\n\n      window.addEventListener('test', stub, opts);\n      window.removeEventListener('test', stub, opts);\n    } catch (e) {\n      console.warn('Browser does not support passive event listeners');\n    }\n\n    _this.state = {\n      currentInput: storedInput || InputType.Initial,\n      currentIntent: storedIntent || InputType.Initial,\n      supportsPassive: supportsPassive || false,\n      isBuffering: false,\n      isScrolling: false,\n      mousePosX: null,\n      mousePosY: null,\n      nested: false\n    };\n    _this.setInput = _this.setInput.bind(_this);\n    _this.setIntent = _this.setIntent.bind(_this);\n    _this.eventBuffer = _this.eventBuffer.bind(_this);\n    return _this;\n  }\n\n  InputProvider.prototype.componentDidMount = function () {\n    elementClosestPolyfill(window);\n\n    if (this.ref.current && this.ref.current.parentElement && this.ref.current.parentElement.closest(\".\" + containerClass)) {\n      this.setState({\n        nested: true\n      });\n      return;\n    }\n\n    this.enableListeners(true);\n  };\n\n  InputProvider.prototype.componentDidUpdate = function () {\n    try {\n      window.sessionStorage.setItem('what-input', this.state.currentInput);\n      window.sessionStorage.setItem('what-intent', this.state.currentIntent);\n    } catch (e) {\n      console.warn('Failed to set input status in session storage' + e);\n    }\n  };\n\n  InputProvider.prototype.componentWillUnmount = function () {\n    window.clearTimeout(this.eventTimer);\n    this.enableListeners(false);\n  };\n\n  InputProvider.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n    if (nextProps !== this.props || nextState.nested !== this.state.nested || nextState.currentInput !== this.state.currentInput || nextState.currentIntent !== this.state.currentIntent) {\n      return true;\n    }\n\n    return false;\n  };\n\n  InputProvider.prototype.enableListeners = function (enable) {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    var options = this.state.supportsPassive ? {\n      passive: true\n    } : false;\n    var fn = enable ? window.addEventListener : window.removeEventListener;\n\n    if (window.PointerEvent) {\n      fn('pointerdown', this.setInput);\n    } else if (window.MSPointerEvent) {\n      fn('MSPointerDown', this.setInput);\n    } else {\n      fn('mousedown', this.setInput);\n\n      if ('ontouchstart' in window) {\n        fn('touchstart', this.eventBuffer, options);\n        fn('touchend', this.setInput);\n      }\n    }\n\n    if (this.provideIntent) {\n      if (window.PointerEvent) {\n        fn('pointermove', this.setIntent);\n      } else if (window.MSPointerEvent) {\n        fn('MSPointerMove', this.setIntent);\n      } else {\n        fn('mousemove', this.setIntent);\n      }\n\n      fn(detectWheel(), this.setIntent, options);\n    }\n\n    fn('keydown', this.eventBuffer);\n    fn('keyup', this.eventBuffer);\n  };\n\n  InputProvider.prototype.setInput = function (event) {\n    if (this.state.isBuffering) {\n      return;\n    }\n\n    var eventKey = 'which' in event ? event.which : undefined;\n    var eventType = event.type;\n    var value = inputEventMap[eventType];\n\n    if (value === InputType.Pointer) {\n      value = getPointerType(event);\n    }\n\n    var ignoreMatch = eventKey ? ignoreMap.indexOf(eventKey) === -1 : undefined;\n    var shouldUpdate = value === InputType.Keyboard && eventKey && ignoreMatch || value === InputType.Mouse || value === InputType.Touch;\n\n    if (this.state.currentInput !== value && shouldUpdate) {\n      this.setState({\n        currentInput: value\n      });\n    }\n\n    if (this.state.currentIntent !== value && shouldUpdate && this.provideIntent) {\n      var activeElem = document.activeElement;\n      var notFormInput = activeElem && activeElem.nodeName && formInputs.indexOf(activeElem.nodeName.toLowerCase()) === -1;\n\n      if (notFormInput) {\n        this.setState({\n          currentIntent: value\n        });\n      }\n    }\n  };\n\n  InputProvider.prototype.setIntent = function (event) {\n    this.detectScrolling(event);\n\n    if (!this.state.isBuffering && !this.state.isScrolling) {\n      var eventType = event.type;\n      var value = inputEventMap[eventType];\n\n      if (value === InputType.Pointer) {\n        value = getPointerType(event);\n      }\n\n      if (this.state.currentIntent !== value) {\n        this.setState({\n          currentIntent: value\n        });\n      }\n    }\n  };\n\n  InputProvider.prototype.eventBuffer = function (event) {\n    var _this = this;\n\n    this.setInput(event);\n    window.clearTimeout(this.eventTimer);\n    this.setState({\n      isBuffering: true\n    });\n    this.eventTimer = window.setTimeout(function () {\n      _this.setState({\n        isBuffering: false\n      });\n    }, 100);\n  };\n\n  InputProvider.prototype.detectScrolling = function (event) {\n    if (this.state.mousePosX !== event.screenX || this.state.mousePosY !== event.screenY) {\n      this.setState({\n        isScrolling: false,\n        mousePosX: event.screenX,\n        mousePosY: event.screenY\n      });\n    } else {\n      this.setState({\n        isScrolling: true\n      });\n    }\n  };\n\n  InputProvider.prototype.render = function () {\n    if (this.state.nested) {\n      return this.props.children;\n    }\n\n    var intent = this.provideIntent ? this.state.currentIntent : null;\n    return React.createElement(\"div\", {\n      className: containerClass,\n      ref: this.ref,\n      \"data-whatinput\": this.state.currentInput,\n      \"data-whatintent\": intent\n    }, this.props.children);\n  };\n\n  return InputProvider;\n}(React.Component);\n\nexport default InputProvider;","map":{"version":3,"sources":["/Users/noshin.kamal/Desktop/Prism_App/node_modules/@workday/canvas-kit-react-core/dist/es6/lib/InputProvider.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","_a","React","elementClosestPolyfill","InputType","InputEventType","formInputs","ignoreMap","inputEventMap","KeyDown","Keyboard","KeyUp","MouseDown","Mouse","MouseMove","Wheel","MouseWheel","DOMMouseScroll","MSPointerDown","Pointer","MSPointerMove","PointerDown","PointerMove","TouchStart","Touch","pointerMap","getPointerType","event","pointerType","detectWheel","wheelType","document","createElement","onmousewheel","undefined","containerClass","InputProvider","_super","props","_this","call","ref","createRef","provideIntent","storedInput","storedIntent","window","sessionStorage","getItem","e","console","warn","supportsPassive","opts","defineProperty","get","stub","addEventListener","removeEventListener","state","currentInput","Initial","currentIntent","isBuffering","isScrolling","mousePosX","mousePosY","nested","setInput","bind","setIntent","eventBuffer","componentDidMount","current","parentElement","closest","setState","enableListeners","componentDidUpdate","setItem","componentWillUnmount","clearTimeout","eventTimer","shouldComponentUpdate","nextProps","nextState","enable","options","passive","fn","PointerEvent","MSPointerEvent","eventKey","which","eventType","type","value","ignoreMatch","indexOf","shouldUpdate","activeElem","activeElement","notFormInput","nodeName","toLowerCase","detectScrolling","setTimeout","screenX","screenY","render","children","intent","className","Component"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar _a;\nimport * as React from 'react';\nimport elementClosestPolyfill from 'element-closest';\nexport var InputType;\n(function (InputType) {\n    InputType[\"Initial\"] = \"initial\";\n    InputType[\"Keyboard\"] = \"keyboard\";\n    InputType[\"Mouse\"] = \"mouse\";\n    InputType[\"Pointer\"] = \"pointer\";\n    InputType[\"Touch\"] = \"touch\";\n})(InputType || (InputType = {}));\nexport var InputEventType;\n(function (InputEventType) {\n    InputEventType[\"KeyDown\"] = \"keydown\";\n    InputEventType[\"KeyUp\"] = \"keyup\";\n    InputEventType[\"MouseDown\"] = \"mousedown\";\n    InputEventType[\"MouseMove\"] = \"mousemove\";\n    InputEventType[\"Wheel\"] = \"wheel\";\n    InputEventType[\"MouseWheel\"] = \"mousewheel\";\n    InputEventType[\"DOMMouseScroll\"] = \"DOMMouseScroll\";\n    InputEventType[\"MSPointerDown\"] = \"MSPointerDown\";\n    InputEventType[\"MSPointerMove\"] = \"MSPointerMove\";\n    InputEventType[\"PointerDown\"] = \"pointerdown\";\n    InputEventType[\"PointerMove\"] = \"pointermove\";\n    InputEventType[\"TouchStart\"] = \"touchstart\";\n})(InputEventType || (InputEventType = {}));\nvar formInputs = ['input', 'select', 'textarea'];\nvar ignoreMap = [\n    16,\n    17,\n    18,\n    91,\n    93,\n];\nexport var inputEventMap = (_a = {},\n    _a[InputEventType.KeyDown] = InputType.Keyboard,\n    _a[InputEventType.KeyUp] = InputType.Keyboard,\n    _a[InputEventType.MouseDown] = InputType.Mouse,\n    _a[InputEventType.MouseMove] = InputType.Mouse,\n    _a[InputEventType.Wheel] = InputType.Mouse,\n    _a[InputEventType.MouseWheel] = InputType.Mouse,\n    _a[InputEventType.DOMMouseScroll] = InputType.Mouse,\n    _a[InputEventType.MSPointerDown] = InputType.Pointer,\n    _a[InputEventType.MSPointerMove] = InputType.Pointer,\n    _a[InputEventType.PointerDown] = InputType.Pointer,\n    _a[InputEventType.PointerMove] = InputType.Pointer,\n    _a[InputEventType.TouchStart] = InputType.Touch,\n    _a);\nvar pointerMap = {\n    2: InputType.Touch,\n    3: InputType.Touch,\n    4: InputType.Mouse,\n};\nvar getPointerType = function (event) {\n    if (typeof event.pointerType === 'number') {\n        return pointerMap[event.pointerType];\n    }\n    else if (event.pointerType === 'mouse') {\n        return InputType.Mouse;\n    }\n    else {\n        return InputType.Touch;\n    }\n};\nvar detectWheel = function () {\n    var wheelType;\n    if ('onwheel' in document.createElement('div')) {\n        wheelType = 'wheel';\n    }\n    else {\n        wheelType = document.onmousewheel !== undefined ? 'mousewheel' : 'DOMMouseScroll';\n    }\n    return wheelType;\n};\nvar containerClass = 'wdc-input-provider';\nvar InputProvider = (function (_super) {\n    __extends(InputProvider, _super);\n    function InputProvider(props) {\n        var _this = _super.call(this, props) || this;\n        _this.ref = React.createRef();\n        _this.provideIntent = _this.props.provideIntent;\n        var storedInput, storedIntent;\n        try {\n            storedInput = window.sessionStorage.getItem('what-input');\n            storedIntent = window.sessionStorage.getItem('what-intent');\n        }\n        catch (e) {\n            console.warn('Failed to retrieve input status from session storage' + e);\n        }\n        var supportsPassive;\n        try {\n            var opts = Object.defineProperty({}, 'passive', {\n                get: function () {\n                    supportsPassive = true;\n                },\n            });\n            var stub = function () {\n                return;\n            };\n            window.addEventListener('test', stub, opts);\n            window.removeEventListener('test', stub, opts);\n        }\n        catch (e) {\n            console.warn('Browser does not support passive event listeners');\n        }\n        _this.state = {\n            currentInput: storedInput || InputType.Initial,\n            currentIntent: storedIntent || InputType.Initial,\n            supportsPassive: supportsPassive || false,\n            isBuffering: false,\n            isScrolling: false,\n            mousePosX: null,\n            mousePosY: null,\n            nested: false,\n        };\n        _this.setInput = _this.setInput.bind(_this);\n        _this.setIntent = _this.setIntent.bind(_this);\n        _this.eventBuffer = _this.eventBuffer.bind(_this);\n        return _this;\n    }\n    InputProvider.prototype.componentDidMount = function () {\n        elementClosestPolyfill(window);\n        if (this.ref.current &&\n            this.ref.current.parentElement &&\n            this.ref.current.parentElement.closest(\".\" + containerClass)) {\n            this.setState({ nested: true });\n            return;\n        }\n        this.enableListeners(true);\n    };\n    InputProvider.prototype.componentDidUpdate = function () {\n        try {\n            window.sessionStorage.setItem('what-input', this.state.currentInput);\n            window.sessionStorage.setItem('what-intent', this.state.currentIntent);\n        }\n        catch (e) {\n            console.warn('Failed to set input status in session storage' + e);\n        }\n    };\n    InputProvider.prototype.componentWillUnmount = function () {\n        window.clearTimeout(this.eventTimer);\n        this.enableListeners(false);\n    };\n    InputProvider.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (nextProps !== this.props ||\n            nextState.nested !== this.state.nested ||\n            nextState.currentInput !== this.state.currentInput ||\n            nextState.currentIntent !== this.state.currentIntent) {\n            return true;\n        }\n        return false;\n    };\n    InputProvider.prototype.enableListeners = function (enable) {\n        if (typeof window === 'undefined') {\n            return;\n        }\n        var options = this.state.supportsPassive\n            ? { passive: true }\n            : false;\n        var fn = enable ? window.addEventListener : window.removeEventListener;\n        if (window.PointerEvent) {\n            fn('pointerdown', this.setInput);\n        }\n        else if (window.MSPointerEvent) {\n            fn('MSPointerDown', this.setInput);\n        }\n        else {\n            fn('mousedown', this.setInput);\n            if ('ontouchstart' in window) {\n                fn('touchstart', this.eventBuffer, options);\n                fn('touchend', this.setInput);\n            }\n        }\n        if (this.provideIntent) {\n            if (window.PointerEvent) {\n                fn('pointermove', this.setIntent);\n            }\n            else if (window.MSPointerEvent) {\n                fn('MSPointerMove', this.setIntent);\n            }\n            else {\n                fn('mousemove', this.setIntent);\n            }\n            fn(detectWheel(), this.setIntent, options);\n        }\n        fn('keydown', this.eventBuffer);\n        fn('keyup', this.eventBuffer);\n    };\n    InputProvider.prototype.setInput = function (event) {\n        if (this.state.isBuffering) {\n            return;\n        }\n        var eventKey = 'which' in event ? event.which : undefined;\n        var eventType = event.type;\n        var value = inputEventMap[eventType];\n        if (value === InputType.Pointer) {\n            value = getPointerType(event);\n        }\n        var ignoreMatch = eventKey ? ignoreMap.indexOf(eventKey) === -1 : undefined;\n        var shouldUpdate = (value === InputType.Keyboard && eventKey && ignoreMatch) ||\n            value === InputType.Mouse ||\n            value === InputType.Touch;\n        if (this.state.currentInput !== value && shouldUpdate) {\n            this.setState({ currentInput: value });\n        }\n        if (this.state.currentIntent !== value && shouldUpdate && this.provideIntent) {\n            var activeElem = document.activeElement;\n            var notFormInput = activeElem &&\n                activeElem.nodeName &&\n                formInputs.indexOf(activeElem.nodeName.toLowerCase()) === -1;\n            if (notFormInput) {\n                this.setState({ currentIntent: value });\n            }\n        }\n    };\n    InputProvider.prototype.setIntent = function (event) {\n        this.detectScrolling(event);\n        if (!this.state.isBuffering && !this.state.isScrolling) {\n            var eventType = event.type;\n            var value = inputEventMap[eventType];\n            if (value === InputType.Pointer) {\n                value = getPointerType(event);\n            }\n            if (this.state.currentIntent !== value) {\n                this.setState({ currentIntent: value });\n            }\n        }\n    };\n    InputProvider.prototype.eventBuffer = function (event) {\n        var _this = this;\n        this.setInput(event);\n        window.clearTimeout(this.eventTimer);\n        this.setState({ isBuffering: true });\n        this.eventTimer = window.setTimeout(function () {\n            _this.setState({ isBuffering: false });\n        }, 100);\n    };\n    InputProvider.prototype.detectScrolling = function (event) {\n        if (this.state.mousePosX !== event.screenX || this.state.mousePosY !== event.screenY) {\n            this.setState({\n                isScrolling: false,\n                mousePosX: event.screenX,\n                mousePosY: event.screenY,\n            });\n        }\n        else {\n            this.setState({ isScrolling: true });\n        }\n    };\n    InputProvider.prototype.render = function () {\n        if (this.state.nested) {\n            return this.props.children;\n        }\n        var intent = this.provideIntent ? this.state.currentIntent : null;\n        return (React.createElement(\"div\", { className: containerClass, ref: this.ref, \"data-whatinput\": this.state.currentInput, \"data-whatintent\": intent }, this.props.children));\n    };\n    return InputProvider;\n}(React.Component));\nexport default InputProvider;\n"]},"metadata":{},"sourceType":"module"}